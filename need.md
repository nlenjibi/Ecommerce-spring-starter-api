//    private Long extractUserId(Authentication authentication) {
//        if (authentication == null || authentication.getPrincipal() == null) {
//            throw new IllegalStateException("User not authenticated");
//        }
//        return (Long) authentication.getPrincipal();
//    }